# Инструкция по наполнению курса (JSON)

Этот файл описывает формат `src/data/course.json` и правила наполнения заданий.

## Общая структура

```json
{
  "meta": {
    "title": "TS Quest",
    "subtitle": "Тренировка TypeScript в стиле Duolingo",
    "locale": "ru-RU",
    "version": "1.1.0",
    "author": "codex"
  },
  "units": [
    {
      "id": "unit-essentials",
      "title": "TS Essentials",
      "description": "Спринт по базовым типам, функциям и дженерикам.",
      "accent": "#0EA5A4",
      "levels": [
        {
          "id": "lvl-types",
          "title": "Типы и вывод",
          "goal": "Научиться читать и задавать базовые типы.",
          "steps": [
            { "..." : "..." }
          ]
        }
      ]
    }
  ]
}
```

## Поля верхнего уровня

- `meta.title`: название курса.
- `meta.subtitle`: подзаголовок/описание курса.
- `meta.locale`: локаль курса (например `ru-RU`).
- `meta.version`: версия контента курса.
- `meta.author`: автор/команда.
- `units`: список модулей.

## Модуль (Unit)

```json
{
  "id": "unit-essentials",
  "title": "TS Essentials",
  "description": "Спринт по базовым типам, функциям и дженерикам.",
  "accent": "#0EA5A4",
  "levels": [ ... ]
}
```

Правила:
- `id`: уникальный идентификатор (латиница, без пробелов).
- `accent`: HEX-цвет (используется в UI карточки модуля).
- `levels`: список уроков в модуле.

## Урок (Level)

```json
{
  "id": "lvl-types",
  "title": "Типы и вывод",
  "goal": "Научиться читать и задавать базовые типы.",
  "steps": [ ... ]
}
```

Правила:
- `id`: уникальный идентификатор.
- `steps`: список заданий (чем больше, тем лучше для тренировки; сейчас в шаблоне 10+ на урок).

## Задание (Step)

Все задания имеют общие поля:

- `id`: уникальный идентификатор задания.
- `type`: тип задания.
- `prompt`: текст вопроса/инструкции.
- `xp`: количество опыта за верный ответ.
- `tip` (опционально): развёрнутая подсказка, скрыта до нажатия "Показать подсказку".
- `explanation` (опционально): объяснение после ответа.

Поддерживаемые типы:

### 1) `choice` (один правильный вариант)

```json
{
  "id": "types-1",
  "type": "choice",
  "prompt": "Какой тип выведет TypeScript для выражения `const age = 21`?",
  "options": ["string", "number", "boolean", "any"],
  "answer": "number",
  "xp": 10,
  "tip": "TypeScript выводит тип из значения. Числовой литерал без `as const` становится `number`."
}
```

Правила:
- `options` будут перемешаны автоматически.
- `answer` должен быть строкой, совпадающей с одним из `options`.

### 2) `fill` (ввод текста)

```json
{
  "id": "types-2",
  "type": "fill",
  "prompt": "Заполни тип: `let title: ____ = 'TS';`",
  "placeholder": "тип",
  "answers": ["string"],
  "xp": 10,
  "tip": "Для строковых значений почти всегда используется тип `string`."
}
```

Правила:
- `placeholder` — только нейтральный текст (не раскрывать ответ).
- `answers` — список допустимых ответов. Сравнение происходит с нормализацией (обрезаются пробелы и кавычки).

### 3) `order` (сборка строки)

```json
{
  "id": "types-3",
  "type": "order",
  "prompt": "Собери корректную строку кода.",
  "tokens": ["const", "done", ":", "boolean", "=", "true", ";"],
  "solution": ["const", "done", ":", "boolean", "=", "true", ";"],
  "xp": 12
}
```

Правила:
- `tokens` будут перемешаны автоматически.
- `solution` — правильный порядок токенов.
- Сравнение идет по точному порядку токенов.

### 4) `match` (сопоставление)

```json
{
  "id": "types-7",
  "type": "match",
  "prompt": "Сопоставь значение и итоговый тип.",
  "left": ["'ok'", "42", "true", "['a']"],
  "right": ["string", "number", "boolean", "string[]"],
  "pairs": [
    { "left": "'ok'", "right": "string" },
    { "left": "42", "right": "number" },
    { "left": "true", "right": "boolean" },
    { "left": "['a']", "right": "string[]" }
  ],
  "xp": 14
}
```

Правила:
- `left` и `right` будут перемешаны автоматически.
- `pairs` задают правильное соответствие.

### 5) `select-line` (выбор строки кода)

```json
{
  "id": "types-4",
  "type": "select-line",
  "prompt": "На какой строке ошибка типа?",
  "lines": [
    "const score: number = '42';",
    "const ok = score > 10;",
    "console.log(ok);"
  ],
  "answerLine": 1,
  "xp": 12,
  "explanation": "`number` нельзя присваивать строке."
}
```

Правила:
- `answerLine` — номер строки, начиная с 1.

## Повторения и ошибки

- В ходе урока автоматически вставляются повторения из предыдущих уроков.
- В конце урока повторяются все задания, где пользователь ошибся.
- Это поведение не требует дополнительных полей в JSON.

## Рекомендации по контенту

- Делайте 10–20 заданий на урок для интенсивной практики.
- Чередуйте типы заданий (choice/fill/order/match/select-line), чтобы снизить утомляемость.
- Подсказки должны быть развёрнутыми, обучающими, без прямого ответа.
- Объяснения после ошибки должны быть короткими и точными.

## Проверка JSON

Для быстрой проверки синтаксиса:

```bash
python3 -m json.tool src/data/course.json > /tmp/course_check.json
```

Если команда завершается без ошибок, JSON корректен.
